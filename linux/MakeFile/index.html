
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.3">
    
    
      
        <title>MakeFile - My Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.3b61ea93.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.39b8e14a.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#makefile" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="My Docs" class="md-header-nav__button md-logo" aria-label="My Docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            My Docs
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              MakeFile
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="My Docs" class="md-nav__button md-logo" aria-label="My Docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    My Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      



  <li class="md-nav__item">
    <a href="../.." class="md-nav__link">
      Welcome to My Wiki
    </a>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" >
    
    <label class="md-nav__link" for="nav-2">
      C
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="C" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        C
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../c/c%E8%AF%AD%E8%A8%80%E6%8B%BE%E9%81%97/" class="md-nav__link">
      C语言拾遗
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
    
    <label class="md-nav__link" for="nav-3">
      C plusplus
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="C plusplus" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        C plusplus
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../c_plusplus/cpp%E7%9F%A5%E8%AF%86%E7%82%B9/" class="md-nav__link">
      Cpp知识点
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../c_plusplus/qt%E5%85%A5%E9%97%A8%E7%9F%A5%E8%AF%86%E7%82%B9/" class="md-nav__link">
      Qt入门知识点
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../c_plusplus/readme/" class="md-nav__link">
      Readme
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  


  
  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Linux
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Linux" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Linux
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../" class="md-nav__link">
      Linux_learn
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../IO/" class="md-nav__link">
      IO
    </a>
  </li>

        
          
          
          


  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        MakeFile
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      MakeFile
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    介绍
  </a>
  
    <nav class="md-nav" aria-label="介绍">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    基本规则
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    命名
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    更新
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#makefile_1" class="md-nav__link">
    Makefile的内容
  </a>
  
    <nav class="md-nav" aria-label="Makefile的内容">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1. 显式规则
  </a>
  
    <nav class="md-nav" aria-label="1. 显式规则">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11" class="md-nav__link">
    1.1 基本规则
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12" class="md-nav__link">
    1.2 清空目标文件的规则
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13" class="md-nav__link">
    1.3 文件名使用通配符
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14" class="md-nav__link">
    1.4 目录搜索
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15" class="md-nav__link">
    1.5 静态模式
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2. 隐式规则
  </a>
  
    <nav class="md-nav" aria-label="2. 隐式规则">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    2.1 自动推导规则
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    2.2 缺省规则
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23" class="md-nav__link">
    2.3 后缀规则
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3.变量
  </a>
  
    <nav class="md-nav" aria-label="3.变量">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    3.1 变量的引用
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32" class="md-nav__link">
    3.2 设置变量
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33" class="md-nav__link">
    3.3 自动化变量
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-makefiles" class="md-nav__link">
    3.4 变量MAKEFILES
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gnu-make" class="md-nav__link">
    GNU make工作方式
  </a>
  
    <nav class="md-nav" aria-label="GNU make工作方式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-gnumake" class="md-nav__link">
    1. GNU的make工作时的执行步骤
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2make" class="md-nav__link">
    2.嵌套Make
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#makefile_2" class="md-nav__link">
    Makefile示例
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../arm%E6%B1%87%E7%BC%96/" class="md-nav__link">
      ARM汇编
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../cmake/" class="md-nav__link">
      CMake
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../link_list/" class="md-nav__link">
      链表
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../linux_shell/" class="md-nav__link">
      Linux shell
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" class="md-nav__link">
      开发环境搭建
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" class="md-nav__link">
      链表
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../%E7%BC%96%E8%AF%91/" class="md-nav__link">
      编译
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" class="md-nav__link">
      网络编程
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B/" class="md-nav__link">
      进程
    </a>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-13" type="checkbox" id="nav-4-13" >
    
    <label class="md-nav__link" for="nav-4-13">
      Linux driver
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Linux driver" data-md-level="2">
      <label class="md-nav__title" for="nav-4-13">
        <span class="md-nav__icon md-icon"></span>
        Linux driver
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../Linux_driver/FileSystem/" class="md-nav__link">
      FileSystem
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../Linux_driver/FreeType/" class="md-nav__link">
      FreeType
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../Linux_driver/bootloader/" class="md-nav__link">
      Bootloader
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../Linux_driver/kernel/" class="md-nav__link">
      Kernel
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../Linux_driver/lcd/" class="md-nav__link">
      Lcd
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../Linux_driver/%E5%86%85%E6%A0%B8%E4%B8%8E%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%83%A7%E5%86%99/" class="md-nav__link">
      内核与文件系统烧写
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../Linux_driver/%E5%86%85%E6%A0%B8%E6%89%93%E8%A1%A5%E4%B8%81%E7%BC%96%E8%AF%91/" class="md-nav__link">
      内核打补丁编译
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../Linux_driver/%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87/" class="md-nav__link">
      字符设备
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../Linux_driver/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" class="md-nav__link">
      开发环境搭建
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../Linux_driver/%E6%9C%80%E5%B0%8F%E6%A0%B9%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" class="md-nav__link">
      最小根文件系统
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../Linux_driver/%E7%B3%BB%E7%BB%9F%E7%A7%BB%E6%A4%8D/" class="md-nav__link">
      系统移植
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../Linux_driver/%E8%AE%BE%E5%A4%87%E6%A0%91/" class="md-nav__link">
      设备树
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../Linux_driver/%E8%AE%BE%E5%A4%87%E6%A8%A1%E5%9E%8B/" class="md-nav__link">
      设备模型
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" >
    
    <label class="md-nav__link" for="nav-5">
      Python
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Python" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon"></span>
        Python
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../python/readme/" class="md-nav__link">
      Readme
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    介绍
  </a>
  
    <nav class="md-nav" aria-label="介绍">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    基本规则
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    命名
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    更新
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#makefile_1" class="md-nav__link">
    Makefile的内容
  </a>
  
    <nav class="md-nav" aria-label="Makefile的内容">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1. 显式规则
  </a>
  
    <nav class="md-nav" aria-label="1. 显式规则">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11" class="md-nav__link">
    1.1 基本规则
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12" class="md-nav__link">
    1.2 清空目标文件的规则
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13" class="md-nav__link">
    1.3 文件名使用通配符
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14" class="md-nav__link">
    1.4 目录搜索
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15" class="md-nav__link">
    1.5 静态模式
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2. 隐式规则
  </a>
  
    <nav class="md-nav" aria-label="2. 隐式规则">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    2.1 自动推导规则
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    2.2 缺省规则
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23" class="md-nav__link">
    2.3 后缀规则
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3.变量
  </a>
  
    <nav class="md-nav" aria-label="3.变量">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    3.1 变量的引用
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32" class="md-nav__link">
    3.2 设置变量
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33" class="md-nav__link">
    3.3 自动化变量
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-makefiles" class="md-nav__link">
    3.4 变量MAKEFILES
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gnu-make" class="md-nav__link">
    GNU make工作方式
  </a>
  
    <nav class="md-nav" aria-label="GNU make工作方式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-gnumake" class="md-nav__link">
    1. GNU的make工作时的执行步骤
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2make" class="md-nav__link">
    2.嵌套Make
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#makefile_2" class="md-nav__link">
    Makefile示例
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="makefile">MakeFile</h1>
<h2 id="_1">介绍</h2>
<h4 id="_2">基本规则</h4>
<pre><code class="language-makefile">目标 ： 依赖
[tab] 命令
</code></pre>
<h4 id="_3">命名</h4>
<p>一般为<code>GNUmakefile</code>， <code>makefile</code>， <code>Makefile</code>，推荐使用<code>Makefile</code></p>
<h4 id="_4">更新</h4>
<p>依赖文件不存在或者文件有更新时，执行make会重新编译</p>
<h2 id="makefile_1">Makefile的内容</h2>
<p>在一个完整的 <code>Makefile</code>中,包含了 5 个东西:</p>
<blockquote>
<p>显式规则、隐含规则、变量定义、指示符和注释</p>
</blockquote>
<ol>
<li><strong>显式规则</strong> ：显式规则说明了，如何生成一个或多的的目标文件。这是由Makefile的书写者明显指出，要生成的文件，文件的依赖文件，生成的命令。</li>
<li><strong>隐晦规则</strong>：由于我们的make有自动推导的功能，所以隐晦的规则可以让我们比较粗糙地简略地书写Makefile，这是由make所支持的。</li>
<li><strong>变量的定义</strong>：在Makefile中我们要定义一系列的变量，变量一般都是字符串，这个有点你C语言中的宏，当Makefile被执行时，其中的变量都会被扩展到相应的引用位置上。</li>
<li><strong>指示符</strong>：其包括了三个部分，一个是在一个Makefile中引用另一个Makefile，就像C语言中的include一样；另一个是指根据某些情况指定Makefile中的有效部分，就像C语言中的预编译#if一样；还有就是定义一个多行的命令。有关这一部分的内容，我会在后续的部分中讲述。</li>
<li><strong>注释</strong>：Makefile中只有行注释，和UNIX的Shell脚本一样，其注释是用“#”字符，这个就像C/C++中的“//”一样。如果你要在你的Makefile中使用“#”字符，可以用反斜框进行转义，如：“#”。</li>
</ol>
<h3 id="1">1. 显式规则</h3>
<h4 id="11">1.1 基本规则</h4>
<pre><code class="language-makefile">目标 ： 依赖
[tab] 命令
</code></pre>
<h4 id="12">1.2 清空目标文件的规则</h4>
<pre><code class="language-makefile">.PHONY clean
clean:
    rm $(OBJS)
</code></pre>
<p><code>.PHONY</code>表示一个伪目标，若不使用<code>.PHONY</code>，再次执行 <code>clean</code>会发现<code>clean</code>是最新的，无法实现清除的目的。<code>.PHONY</code>表示一个伪目标，并不是真是存在的，所以每次都可以执行<code>clean</code> 。</p>
<h4 id="13">1.3 文件名使用通配符</h4>
<p>Maekfile 中表示文件名时可使用通配符。可使用的通配符有:<code>*</code>、<code>?</code>和<code>[...]</code>。
在 Makefile 中通配符的用法和含义和 Linux(unix)的 Bourne shell 完全相同。例如,<code>*.c”</code>代表了当前工作目录下所有的以<code>.c</code>结尾的文件等。但是在 Makefile 中这些统配符并不是可以用在任何地方,Makefile 中统配符可以出现在以下两种场合:</p>
<ol>
<li>
<p>可以用在规则的目标、依赖中,make 在读取 Makefile 时会自动对其进行匹配处理(通配符展开);</p>
</li>
<li>
<p>可出现在规则的命令中,通配符的通配处理是在 shell 在执行此命令时完成的。</p>
</li>
</ol>
<p>除这两种情况之外的其它上下文中,不能直接使用通配符。而是需要通过函数<code>wildcard</code>来实现。</p>
<h4 id="14">1.4 目录搜索</h4>
<ul>
<li>一般搜索<code>VPATH</code></li>
</ul>
<p><code>VPATH = src:../headers</code></p>
<ul>
<li>选择性搜索<code>vpath</code></li>
<li>目录搜索机制</li>
<li>命令行和搜索目录</li>
<li>隐含规则和搜索目录</li>
<li>库文件和搜索路径</li>
</ul>
<h4 id="15">1.5 静态模式</h4>
<pre><code class="language-makefile">TARGETS ...: TARGET-PATTERN: PREREQ-PATTERNS ...
    COMMANDS

objects = foo.o bar.o
all: $(objects)


$(objects): %.o: %.c
    $(CC) -c $(CFLAGS) $&lt; -o $@
</code></pre>
<p>规则描述了所有的.o文件的依赖文件为对应的.c文件,对于目标“foo.o”,取其茎“foo”替代对应的依赖模式“%.c”中的模式字符“%”之后可得到目标的依赖文件“foo.c”</p>
<h3 id="2">2. 隐式规则</h3>
<h4 id="21">2.1 自动推导规则</h4>
<p><code>make</code>本身存在一个默认的规则,能够自动完成对<code>.c</code>文件的编译并生成对应的<code>.o</code>文件。我们就可以省略掉描述<code>.c</code>文件和<code>.o</code>依赖关系的规则,而只需要给出那些特定的规则描述</p>
<pre><code class="language-makefile"># sample Makefile
objects = main.o kbd.o command.o 

edit : $(objects)
    cc -o edit $(objects)
main.o : defs.h         #自动推导
kbd.o : defs.h command.h
command.o : defs.h command.h

.PHONY : clean
clean :
    rm edit $(objects)
</code></pre>
<h4 id="22">2.2 缺省规则</h4>
<h4 id="23">2.3 后缀规则</h4>
<h3 id="3">3.变量</h3>
<h4 id="31">3.1 变量的引用</h4>
<p>变量引用的展开过程是严格的文本替换过程,就是说变量值的字符串被精确的展开在变量被引用的地方。因此规则:</p>
<pre><code class="language-makefile">foo = c
prog.o : prog.$(foo)
    $(foo) $(foo) -$(foo) prog.$(foo)
</code></pre>
<p>被展开后就是:</p>
<pre><code class="language-makefile">prog.c : prog.c
    cc -c prog.c
</code></pre>
<h4 id="32">3.2 设置变量</h4>
<ul>
<li><code>=</code>：递归方式</li>
<li><code>：=</code>：静态方式</li>
<li><code>+=</code>：追加方式</li>
<li><code>？=</code>：条件赋值</li>
</ul>
<h4 id="33">3.3 自动化变量</h4>
<ul>
<li><code>$@</code>：表示规则的目标文件</li>
<li><code>$&lt;</code>：规则的第一依赖文件</li>
<li><code>$^</code>：规则的所有依赖文件表</li>
<li><code>$?</code>：所有比目标文件更新的依赖文件表</li>
</ul>
<h4 id="34-makefiles">3.4 变量<code>MAKEFILES</code></h4>
<p>如果在当前环境定义了一个<code>MAKEFILES</code>环境变量,make执行时首先将此变量的值作为需要读入的Makefile文件,多个文件之间使用空格分开。类似使用指示符<code>include</code>包含其它Makefile文件一样,如果文件名非绝对路径而且当前目录也不存在此文件,make会在一些默认的目录去寻找。
它和使用<code>include</code>的区别:</p>
<ol>
<li>环境变量指定的 makefile 文件中的<code>目标</code>不会被作为<code>make</code> 执行的<code>终极目标</code>。就是说,这些文件中所定义规则的目标,<code>make</code> 不会将其作为<code>终极目标</code>来看待。<code>make</code> 执行时的<code>终极目标</code>就是当前目录下这个文件中所定义的<code>终极目标</code>。</li>
<li>环境变量所定义的文件列表,在执行 make 时,如果不能找到其中某一个文件(不存在或者无法创建)。make 不会提示错误,也不退出。就是说环境变量<code>MAKEFILES</code>定义的包含文件是否存在不会导致 make 错误(这是比较隐蔽的地方)。</li>
<li>make 在执行时,首先读取的是环境变量<code>MAKEFILES</code>所指定的文件列表,之后才是工作目录下的 makefile 文件,<code>include</code>所指定的文件是在 make 发现此关键字的时、暂停正在读取的文件而转去读取<code>include</code>所指定的文件。</li>
<li>变量<code>MAKEFILES</code>主要用在<code>make</code>的递归调用过程中的的通信，实际应用中很少设置此变量。因为一旦设置了此变量,在多级make
    调用时;由于每一级make都会读取“MAKEFILES”变量所指定的文件,将导致执行出,现混乱。</li>
</ol>
<h2 id="gnu-make">GNU make工作方式</h2>
<h4 id="1-gnumake">1. GNU的make工作时的执行步骤</h4>
<ol>
<li>读入所有的Makefile。</li>
<li>读入被include的其它Makefile。</li>
<li>初始化文件中的变量。</li>
<li>推导隐晦规则，并分析所有规则。</li>
<li>为所有的目标文件创建依赖关系链。</li>
<li>根据依赖关系，决定哪些目标要重新生成。</li>
<li>执行生成命令。</li>
</ol>
<p>1-5步为第一个阶段，6-7为第二个阶段。第一个阶段中，如果定义的变量被使用了，那么，make会把其展开在使用的位置。但make并不会完全马上展开，make使用的是拖延战术，如果变量出现在依赖关系的规则中，那么仅当这条依赖被决定要使用了，变量才会在其内部展开</p>
<h4 id="2make">2.嵌套Make</h4>
<p>在一些大的工程中，我们会把我们不同模块或是不同功能的源文件放在不同的目录中，我们可以在每个目录中都书写一个该目录的Makefile，这有利于让我们的Makefile变得更加地简洁，而不至于把所有的东西全部写在一个Makefile中，这样会很难维护我们的Makefile，这个技术对于我们模块编译和分段编译有着非常大的好处。
      例如，我们有一个子目录叫subdir，这个目录下有个Makefile文件，来指明了这个目录下文件的编译规则。那么我们总控的Makefile可以这样书写：</p>
<pre><code class="language-makefile">subsystem:
    cd subdir &amp;&amp; $(MAKE)
</code></pre>
<p>其等价于：</p>
<pre><code class="language-makefile">subsystem:
    $(MAKE) -C subdir
</code></pre>
<p>定义<code>$(MAKE)</code>宏变量的意思是，也许我们的<code>make</code>需要一些参数，所以定义成一个变量比较利于维护。这两个例子的意思都是先进入<code>subdir</code>目录，然后执行<code>make</code>命令。</p>
<h4 id="makefile_2">Makefile示例</h4>
<pre><code class="language-makefile">
# $(notdir $(CURDIR)) 获取目录名

TARGET = $(notdir $(CURDIR))

CROSS_COMPILE = gcc

SOURCES = $(wildcard *.c)
HEADERS = $(wildcard *.h)

#静态模式规则 .c 替换成 .o
OBJFILES = $(patsubst %.c,%.o,$(SOURCES))
#OBJFILES = $(SOURCES:%.c=%.o)

all:$(TARGET)
    @echo builded target:$^
$(TARGET): $(OBJFILES)
    @echo linking $@ from $^
    $(CROSS_COMPILE) -o  $@ $^
    @echo obj $(OBJFILES)
$(OBJFILES): %.o:%.c
    @echo compilinng $@ from $&lt; ...
    $(CROSS_COMPILE) -c $&lt; -o $@
    @echo Compile finished
.PHONY :clean
clean:
    @echo Removing generated files
    rm -rf $(TARGET) *.d *.o
</code></pre>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../IO/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                IO
              </div>
            </div>
          </a>
        
        
          <a href="../arm%E6%B1%87%E7%BC%96/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                ARM汇编
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.08c56446.min.js"></script>
      <script src="../../assets/javascripts/bundle.6ced434e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>